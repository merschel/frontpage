import { SettingsDialogComponent } from './../settings-dialog/settings-dialog.component'
import { Component, OnInit, Input } from '@angular/core'
import { GroupStorageService } from './../../services/group-storage.service'
import { MatDialog } from '@angular/material'
import { Group } from './../../model/group'
import { DropZoneDialogComponent } from './../drop-zone-dialog/drop-zone-dialog.component'

@Component({
  selector: 'app-action-bar',
  templateUrl: './action-bar.component.html',
  styleUrls: ['./action-bar.component.css']
})
export class ActionBarComponent implements OnInit {

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //   Input Variables    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  @Input() group: Group

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //   Output Variables    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //   Member Variables    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //    Constructor    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  constructor(private groupStorage: GroupStorageService,
              private dialog: MatDialog) { }

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //   Life Cycle Functions     //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  ngOnInit() {
  }

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //    Public Functions    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  onExport() {
    this.groupStorage.export()
  }

  onImport() {
    let dialogRef = this.dialog.open(DropZoneDialogComponent)
  }

  onSettings() {

    let dialogRef = this.dialog.open(SettingsDialogComponent, {
      data: this.group
    })

    dialogRef.afterClosed().subscribe( group => {

      if ( group ) {
        this.groupStorage.onChange()
      }

    })

  }

  onAddGroup() {

    let dialogRef = this.dialog.open( SettingsDialogComponent )

    dialogRef.afterClosed().subscribe( group => {

      if ( group ) {
        this.groupStorage.add(group)
      }

    })

  }

  onOpenAll() {

    this.group.tiles.forEach( tile => {
      window.open( tile.scheme + '//' + tile.url, '_blank')
    })

  }

  //////////////////////////////////////////////
  //////////////////////////////////////////////
  //   Private Functions    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  //////////////////////////////////////////////
  //////////////////////////////////////////////
           //   Getter and Setter    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

}
