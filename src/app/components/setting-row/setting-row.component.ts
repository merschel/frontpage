import { GroupStorageService } from './../../services/group-storage.service'
import { FormGroup, FormBuilder } from '@angular/forms'
import { Group } from './../../model/group'
import { Component, OnInit, Input } from '@angular/core'

@Component({
  selector: 'app-setting-row',
  templateUrl: './setting-row.component.html',
  styleUrls: ['./setting-row.component.css']
})
export class SettingRowComponent implements OnInit {

  //////////////////////////////////////////////
  //////////////////////////////////////////////
          //   Input Variables    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  @Input() group: Group

  //////////////////////////////////////////////
  //////////////////////////////////////////////
          //   Output Variables    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  //////////////////////////////////////////////
  //////////////////////////////////////////////
          //   Member Variables    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  mForm: FormGroup

  //////////////////////////////////////////////
  //////////////////////////////////////////////
            //    Constructor    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  constructor( private formBuilder: FormBuilder,
               private groupStorage: GroupStorageService ) { }

  //////////////////////////////////////////////
  //////////////////////////////////////////////
          //   Life Cycle Functions     //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  ngOnInit() {
    this.setValues()
    this.onChange()
  }

  //////////////////////////////////////////////
  //////////////////////////////////////////////
           //    Public Functions    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  //////////////////////////////////////////////
  //////////////////////////////////////////////
           //   Private Functions    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

  private setValues() {

    this.mForm = this.formBuilder.group({

      name: this.group.name,
      numberOfColumns: this.group.settings.numberOfColumns

    })

  }

  private onChange() {

    this.mForm.valueChanges.subscribe( values => {

      this.group.name = values.name
      this.group.settings.numberOfColumns = values.numberOfColumns

      this.groupStorage.onChange()

    })

  }

  //////////////////////////////////////////////
  //////////////////////////////////////////////
           //   Getter and Setter    //
  //////////////////////////////////////////////
  //////////////////////////////////////////////

}
